<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Badminton Footwork Trainer</title>
<style>
  :root{
    --bg:#071428;
    --size:140px;
    --arrow-fill:#444;
    --highlight:#00ff88;
  }
  html,body{
    height:100%;margin:0;
    background:linear-gradient(180deg,var(--bg),#031020);
    display:flex;flex-direction:column;
    align-items:center;justify-content:center;
    font-family:Arial,Helvetica,sans-serif;color:#dbeafe;
    padding:10px;
    box-sizing:border-box;
  }
  .controls{
    margin-bottom:20px;
    display:flex;
    gap:10px;
    flex-wrap:wrap;
    justify-content:center;
  }
  .controls input{
    width:70px;text-align:center;font-size:16px;padding:4px;
  }
  .controls button{
    font-size:16px;padding:6px 14px;cursor:pointer;
  }

  .board{
    width:90vw;max-width:720px;
    height:90vw;max-height:720px;
    position:relative;
  }

  .arrow{
    position:absolute;width:var(--size);height:var(--size);
    display:flex;align-items:center;justify-content:center;
    transition:transform .2s ease,filter .18s ease;
    --tx:translate(0,0);
    transform:var(--tx);opacity:0.7;
  }
  .arrow.active{
    transform:var(--tx) scale(1.25);
    filter:drop-shadow(0 14px 30px rgba(0,255,136,0.18));
    opacity:1;z-index:5;
  }
  .icon{width:78%;height:78%;}
  .icon svg path{fill:var(--arrow-fill);transition:fill .18s ease,stroke .18s ease;}
  .arrow.active .icon svg path{fill:var(--highlight);stroke:rgba(0,255,136,0.85);stroke-width:1;}

  .up{top:6%;left:50%;--tx:translate(-50%,0);}
  .down{bottom:6%;left:50%;--tx:translate(-50%,0);}
  .left{left:6%;top:50%;--tx:translate(0,-50%);}
  .right{right:6%;top:50%;--tx:translate(0,-50%);}
  .up-left{top:12%;left:12%;--tx:translate(-50%,-50%);}
  .up-right{top:12%;right:12%;--tx:translate(50%,-50%);}
  .down-left{bottom:12%;left:12%;--tx:translate(-50%,50%);}
  .down-right{bottom:12%;right:12%;--tx:translate(50%,50%);}

  .up .icon{transform:rotate(0);}
  .up-right .icon{transform:rotate(45deg);}
  .right .icon{transform:rotate(90deg);}
  .down-right .icon{transform:rotate(135deg);}
  .down .icon{transform:rotate(180deg);}
  .down-left .icon{transform:rotate(-135deg);}
  .left .icon{transform:rotate(-90deg);}
  .up-left .icon{transform:rotate(-45deg);}

  @media(max-width:720px){
    :root{--size:90px;}
  }

  /* Thanh tiến trình ngang */
  .progress-container {
    margin-top: 20px;
    width:90vw;max-width:720px;
    height:20px;
    background:#222;
    border-radius:10px;
    overflow:hidden;
  }
  .progress-bar {
    height:100%;
    width:100%;
    background:green;
    transform-origin:left;
    transform:scaleX(0);
    transition:transform 0.1s linear;
  }
</style>
</head>
<body>
  <div class="controls">
    <label>Giây: <input type="number" id="seconds" value="5" min="1"></label>
    <button id="startBtn">Bắt đầu</button>
    <button id="stopBtn">Dừng</button>
  </div>

  <div class="board" id="board">
    <div class="arrow up"><div class="icon"><svg viewBox="0 0 100 100"><path d="M50 10 L74 38 H58 V88 H42 V38 H26 Z"/></svg></div></div>
    <div class="arrow up-right"><div class="icon"><svg viewBox="0 0 100 100"><path d="M50 10 L74 38 H58 V88 H42 V38 H26 Z"/></svg></div></div>
    <div class="arrow right"><div class="icon"><svg viewBox="0 0 100 100"><path d="M50 10 L74 38 H58 V88 H42 V38 H26 Z"/></svg></div></div>
    <div class="arrow down-right"><div class="icon"><svg viewBox="0 0 100 100"><path d="M50 10 L74 38 H58 V88 H42 V38 H26 Z"/></svg></div></div>
    <div class="arrow down"><div class="icon"><svg viewBox="0 0 100 100"><path d="M50 10 L74 38 H58 V88 H42 V38 H26 Z"/></svg></div></div>
    <div class="arrow down-left"><div class="icon"><svg viewBox="0 0 100 100"><path d="M50 10 L74 38 H58 V88 H42 V38 H26 Z"/></svg></div></div>
    <div class="arrow left"><div class="icon"><svg viewBox="0 0 100 100"><path d="M50 10 L74 38 H58 V88 H42 V38 H26 Z"/></svg></div></div>
    <div class="arrow up-left"><div class="icon"><svg viewBox="0 0 100 100"><path d="M50 10 L74 38 H58 V88 H42 V38 H26 Z"/></svg></div></div>
  </div>

  <!-- Thanh tiến trình nằm ngang -->
  <div class="progress-container"><div class="progress-bar" id="progressBar"></div></div>

  <!-- Âm thanh badminton -->
  <audio id="hitSound" src="badminton-hit.mp3" preload="auto"></audio>

<script>
  const arrows = Array.from(document.querySelectorAll('.arrow'));
  const progressBar = document.getElementById('progressBar');
  const hitSound = document.getElementById('hitSound');
  let last = -1, timerId = null;

  function playHit(){
    try {
      hitSound.currentTime = 0;
      hitSound.play();
    } catch(e){}
  }

  function highlightRandom(){
    arrows.forEach(a=>a.classList.remove('active'));
    let idx;
    do{ idx = Math.floor(Math.random()*arrows.length); }while(arrows.length>1 && idx===last);
    arrows[idx].classList.add('active');
    last = idx;
    playHit();
    if(navigator.vibrate) navigator.vibrate(60);
  }

  function start(){
    stop();
    if(document.documentElement.requestFullscreen){
      document.documentElement.requestFullscreen().catch(()=>{});
    }
    const sec = parseInt(document.getElementById('seconds').value)||5;
    highlightRandom();
    let elapsed = 0;
    timerId = setInterval(()=>{
      elapsed += 0.1;
      let percent = elapsed / sec;
      if(percent >= 1){
        elapsed = 0;
        highlightRandom();
      }
      progressBar.style.transform = `scaleX(${percent})`;
      const r = Math.floor(0 + percent*255);
      const g = Math.floor(255 - percent*255);
      progressBar.style.backgroundColor = `rgb(${r},${g},0)`;
    },100);
  }

  function stop(){
    if(timerId){ clearInterval(timerId); timerId=null; }
    progressBar.style.transform = "scaleX(0)";
    arrows.forEach(a=>a.classList.remove('active'));
    if(document.fullscreenElement){
      document.exitFullscreen().catch(()=>{});
    }
  }

  document.getElementById('startBtn').addEventListener('click', start);
  document.getElementById('stopBtn').addEventListener('click', stop);
</script>
</body>
</html>
